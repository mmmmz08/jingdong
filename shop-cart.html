<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./css/shop-cart.css">
    <script src="./js/index.js"></script>
</head>

<body>
    <nav class="header fixed">
        <div class="h-left">
            <a href="javascript:;" class="h-back"></a>
        </div>
        <div class="h-cnt">
            <div class="flex-box">
                <h2 class="h-tit">购物车</h2>
                <div class="h-add">
                    <img src="./images/下载 (7).png" alt="">
                    <span>北京市</span>
                </div>
            </div>
            <div class="h-right">
                <p class="h-edit">编辑</p>
                <p class="h-btn"></p>
            </div>
        </div>
        <!--隐藏-->
        <ul class="nav_ulist" id="nav_ulist">
            <li><a href="" class="iconn-44">首页</a></li>
            <li><a href="" class="iconn-15">分类搜索</a></li>
            <li><a href="./shop-cart.html" class="iconn-32">购物车</a></li>
            <li><a href="./my-gome.html" class="iconn-90">我的国美</a></li>
        </ul>
    </nav>
    <div class="tips-box">
        <div class="drop-tip-box">
            <div class="drop-tip">
                <span class="icon"></span>
                <p>立即开通九九会员享受会员折扣</p>
                <p class="open">去开通</p>
            </div>
        </div>
    </div>

    <div class="shop-container">
        <div class="shop">
            <div class="shop-header">
                <p class="option-boxs"></p>
                <div class="name-box">
                    <div class="icon">
                        <img src="./images/T1hsx4Bybv1RCvBVdK.png" alt="">
                    </div>
                    <h2 class="name">洋钒化妆品专营店</h2>
                </div>
            </div>
        </div>
        <div>
            <div class="product-group card-bg">
                <div class="cart-product">
                    <div class="main-cont">
                        <p class="option-box"></p>
                        <div class="product-cont">
                            <div class="img-box">
                                <img src="./images/T1L.JKBKDv1RCvBVdK_250.jpg" alt="">
                            </div>
                            <div class="info-box">
                                <h3 class="name">
                                    <span>Dior迪奥烈艳蓝金唇膏口红3.5g(080#樱桃红)</span>
                                </h3>
                                <div class="sku">
                                    <div class="sku-inner more">
                                        <span class="sku-span">080#樱桃红</span>
                                        <span class="icon"></span>
                                    </div>
                                </div>
                                <div class="sku">
                                    <p class="rush-span">
                                        <span>限购99件</span>
                                    </p>
                                </div>
                                <div class="price-and-num">
                                    <p class="price">
                                        <span>¥<strong>219</strong></span>
                                    </p>
                                    <div class="count-wrap">
                                        <div class="counter-box">
                                            <span class="count-btn reduces">-</span>
                                            <input type="text" class="count-num" value="1">
                                            <span class="count-btn adds">+</span>
                                        </div>
                                    </div>
                                </div>
                                <p class="bottom">删除</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="shop-container">
        <div class="shop">
            <div class="shop-header">
                <p class="option-boxs"></p>
                <div class="name-box">
                    <div class="icon">
                        <img src="./images/T1hsx4Bybv1RCvBVdK.png" alt="">
                    </div>
                    <h2 class="name">洋钒化妆品专营店</h2>
                </div>
            </div>
        </div>
        <div>
            <div class="product-group card-bg">
                <div class="cart-product">
                    <div class="main-cont">
                        <p class="option-box"></p>
                        <div class="product-cont">
                            <div class="img-box">
                                <img src="./images/T1i2JKB_xv1RCvBVdK_250.jpg" alt="">
                            </div>
                            <div class="info-box">
                                <h3 class="name">
                                    <span>百草味酸奶果粒块54g （芒果+香蕉+火龙果口味）</span>
                                </h3>
                                <div class="sku">
                                    <div class="sku-inner more">
                                        <span class="sku-span">080#樱桃红</span>
                                        <span class="icon"></span>
                                    </div>
                                </div>
                                <div class="sku">
                                    <p class="rush-span">
                                        <span>限购99件</span>
                                    </p>
                                </div>
                                <div class="price-and-num">
                                    <p class="price">
                                        <span>¥<strong>219</strong></span>
                                    </p>
                                    <div class="count-wrap">
                                        <div class="counter-box">
                                            <span class="count-btn reduces">-</span>
                                            <input type="text" class="count-num" value="1">
                                            <span class="count-btn adds">+</span>
                                        </div>
                                    </div>
                                </div>
                                <p class="bottom">删除</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="product-group card-bg">
                <div class="cart-product">
                    <div class="main-cont">
                        <p class="option-box"></p>
                        <div class="product-cont">
                            <div class="img-box">
                                <img src="./images/T1WTA5ByA_1RCvBVdK_250.jpg" alt="">
                            </div>
                            <div class="info-box">
                                <h3 class="name">
                                    <span>百草味黄桃干100g 芒果干草莓脆休闲网红办公室零食水...</span>
                                </h3>
                                <div class="sku">
                                    <div class="sku-inner more">
                                        <span class="sku-span">080#樱桃红</span>
                                        <span class="icon"></span>
                                    </div>
                                </div>
                                <div class="sku">
                                    <p class="rush-span">
                                        <span>限购99件</span>
                                    </p>
                                </div>
                                <div class="price-and-num">
                                    <p class="price">
                                        <span>¥<strong>219</strong></span>
                                    </p>
                                    <div class="count-wrap">
                                        <div class="counter-box">
                                            <span class="count-btn reduces">-</span>
                                            <input type="text" class="count-num" value="1">
                                            <span class="count-btn adds">+</span>
                                        </div>
                                    </div>
                                </div>
                                <p class="bottom">删除</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="pay-bar">
        <div class="all">
            <p class="alls"></p>
            <label for="">全选</label>
        </div>
        <div class="total-price-box">
            <p class="total-price">合计:
                <span>¥</span>
                <strong></strong>
            </p>
            <p class="total-price-desc">
                <img src="./images/下载 (14).png" alt="">
                <span>运费说明</span>
            </p>
        </div>
        <p class="button-box">
            去结算(
            <strong>0</strong>
            )
        </p>
    </div>
    <script>
        var hbtn=document.querySelector('.h-btn')
        var navlist=document.querySelector('.nav_ulist')
        hbtn.onclick=function(){
            navlist.classList.toggle('nav-lists')
        }
        var hleft=document.querySelector('.h-left')
        hleft.onclick=function(){
            window.location.href='jingxuan.html'
        }
        var optionbox = document.querySelectorAll('.option-box')
        var alls = document.querySelector('.alls')
        //全选按钮，
        alls.onclick = function () {
            alls.classList.toggle('active5')
            //控制商品状态，点击全选按钮，实现商品的全选效果
            for (var i = 0; i < optionbox.length; i++) {
                if (alls.classList.contains('active5')) {
                    optionbox[i].classList.add('active4')
                } else {
                    optionbox[i].classList.remove('active4')
                }
            }
            //控制店铺名字，如果点击全选按钮，实现店铺名字的全选
            for (var i = 0; i < optionboxs.length; i++) {
                if (alls.classList.contains('active5')) {
                    optionboxs[i].classList.add('active3')
                } else {
                    optionboxs[i].classList.remove('active3')
                }
            }


            count()
        }
        //商品是否选择
        optionbox.forEach(function (item, index) {
            item.onclick = function () {
                item.classList.toggle('active4')
                //实现商品如果实现全部选中，店铺可以实现选中效果
                var ele1 = this.parentNode.parentNode.parentNode.parentNode.children;
                var ele2 = this.parentNode.parentNode.parentNode.parentNode.children[0].parentNode.parentNode.children[0].children[0].children[0]
                var shop = 0;
                for (var i = 0; i < ele1.length; i++) {
                    if (ele1[i].children[0].children[0].children[0].classList.contains('active4')) {
                        shop++;
                    }
                }
                if (shop == ele1.length) {
                    ele2.classList.add('active3')
                } else {
                    ele2.classList.remove('active3')
                }


                //  实现全选的效果
                //   如果所有的店铺都选中了，则全选按钮也要选中 
                var shopnum = 0;
                for (var i = 0; i < optionboxs.length; i++) {
                    if (optionboxs[i].classList.contains('active3')) {
                        shopnum++
                    }
                }
                if (shopnum == optionboxs.length) {
                    alls.classList.add('active5')
                } else {
                    alls.classList.remove('active5')
                }

                count()
            }
        })
        //实现店铺选中，商品全选
        var optionboxs = document.querySelectorAll('.option-boxs')
        optionboxs.forEach(function (item, index) {
            item.onclick = function () {
                item.classList.toggle('active3')
                if (item.classList.contains('active3')) {
                    // console.log(this.parentNode.parentNode.nextElementSibling.children);
                    var ele = this.parentNode.parentNode.nextElementSibling.children
                    for (var i = 0; i < ele.length; i++) {
                        ele[i].children[0].children[0].children[0].classList.add('active4')
                    }
                } else {
                    var ele = this.parentNode.parentNode.nextElementSibling.children
                    for (var i = 0; i < ele.length; i++) {
                        ele[i].children[0].children[0].children[0].classList.remove('active4')
                    }
                }


                //  实现全选的效果
                //   如果所有的店铺都选中了，则全选按钮也要选中 
                var shopnum = 0;
                for (var i = 0; i < optionboxs.length; i++) {
                    if (optionboxs[i].classList.contains('active3')) {
                        shopnum++
                    }
                }
                if (shopnum == optionboxs.length) {
                    alls.classList.add('active5')
                } else {
                    alls.classList.remove('active5')
                }

                count()

            }

        })
        var add = document.querySelectorAll('.adds')
        var reduces = document.querySelectorAll('.reduces')
        var nums = document.querySelectorAll('.counter-box .count-num')
        var price1 = document.querySelectorAll('.info-box .price strong')
        var total = document.querySelector('.total-price strong')
        var sum = document.querySelector('.button-box strong')

        // console.log(price1[0].innerHTML);
        //点击增加
        add.forEach(function (item, index) {
            var prices = price1[index].innerHTML
            item.onclick = function () {
                //控制商品是选中的状态
                optionbox[index].classList.add('active4')
                //如果商品都进行增加，则店铺名字都选中
                // optionboxs[index].classList.add('active4')
                var num1 = parseInt(nums[index].value);
                num1++
                nums[index].value = num1
                //计算价钱
                price1[index].innerHTML = (num1 * prices).toFixed(2)
                // //点击商品数量的改变，也相当于实现全选lo
                var ele2 = this.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.children;
                var num2 = 0
                for (var i = 0; i < ele2.length; i++) {
                    if (ele2[i].children[0].children[0].children[0].classList.contains('active4')) {
                        num2++
                    }
                }
                if (num2 == ele2.length) {
                    console.log(this.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.children[0].children[0].children[0]);
                    this.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.children[0].children[0].children[0].classList.add('active3')
                } else {
                    this.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.children[0].children[0].children[0].classList.remove('active3')
                }

                //  实现全选的效果
                //   如果所有的店铺都选中了，则全选按钮也要选中 
                var shopnum = 0;
                for (var i = 0; i < optionboxs.length; i++) {
                    if (optionboxs[i].classList.contains('active3')) {
                        shopnum++
                    }
                }
                if (shopnum == optionboxs.length) {
                    alls.classList.add('active5')
                } else {
                    alls.classList.remove('active5')
                }

                count()


            }
        })
        //减少
        reduces.forEach(function (item, index) {
            var prices = price1[index].innerHTML
            item.onclick = function () {
                var num1 = parseInt(nums[index].value);
                num1--;
                if (num1 < 1) {
                    num1 = 1
                }
                nums[index].value = num1
                //计算价钱
                price1[index].innerHTML = (num1 * prices).toFixed(2)

                count()
            }
        })
        var product = document.querySelectorAll('.product-group')

        function count() {
            var sumss = 0
            var total_sum = 0
            total.innerHTML = '0.00'
            sum.innerHTML = '0'
            for (var i = 0; i < product.length; i++) {
                if (optionbox[i].classList.contains('active4')) {
                    sumss += parseInt(nums[i].value)
                    sum.innerHTML = sumss
                    total_sum += parseFloat(price1[i].innerHTML)
                    total.innerHTML = total_sum.toFixed(2)
                }
            }

        }



    </script>
</body>
</html>
